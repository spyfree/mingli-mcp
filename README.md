# å‘½ç†MCPæœåŠ¡ (Mingli MCP Server)

ä¸€ä¸ªæ”¯æŒå¤šç§å‘½ç†ç³»ç»Ÿï¼ˆç´«å¾®æ–—æ•°ã€å…«å­—ã€å æ˜Ÿç­‰ï¼‰çš„ Model Context Protocol (MCP) æœåŠ¡å™¨ï¼Œä¸“ä¸º AI å·¥å…·ï¼ˆå¦‚ Cursor IDEï¼‰è®¾è®¡ã€‚

## âœ¨ ç‰¹æ€§

### ðŸŽ¯ æ ¸å¿ƒç‰¹æ€§
- âœ… **å¤šå‘½ç†ç³»ç»Ÿæ”¯æŒ**: é‡‡ç”¨æ’ä»¶åŒ–æž¶æž„ï¼Œè½»æ¾æ‰©å±•æ–°çš„å‘½ç†ç³»ç»Ÿ
  - âœ… ç´«å¾®æ–—æ•°ï¼ˆå·²å®žçŽ°ï¼‰
  - âœ… å…«å­—ï¼ˆå·²å®žçŽ°ï¼‰â­ **æ–°å¢ž**
  - ðŸ”„ è¥¿æ–¹å æ˜Ÿï¼ˆé¢„ç•™æŽ¥å£ï¼‰
- âœ… **å¤šè¯­è¨€æ”¯æŒ**: æ”¯æŒ6ç§è¯­è¨€è¾“å‡º â­ **æ–°å¢ž**
  - ðŸ‡¨ðŸ‡³ ç®€ä½“ä¸­æ–‡ (zh-CN)
  - ðŸ‡¹ðŸ‡¼ ç¹ä½“ä¸­æ–‡ (zh-TW)
  - ðŸ‡ºðŸ‡¸ English (en-US)
  - ðŸ‡¯ðŸ‡µ æ—¥æœ¬èªž (ja-JP)
  - ðŸ‡°ðŸ‡· í•œêµ­ì–´ (ko-KR)
  - ðŸ‡»ðŸ‡³ Tiáº¿ng Viá»‡t (vi-VN)
- âœ… **å¤šä¼ è¾“æ–¹å¼**: æ”¯æŒstdioã€HTTPã€WebSocketç­‰å¤šç§ä¼ è¾“åè®®
- âœ… **MCPæ ‡å‡†å…¼å®¹**: å®Œå…¨å…¼å®¹ MCP åè®®è§„èŒƒ
- âœ… **æ˜“äºŽæ‰©å±•**: æ¸…æ™°çš„æŠ½è±¡å±‚è®¾è®¡ï¼Œæ·»åŠ æ–°ç³»ç»Ÿåªéœ€3æ­¥

### ðŸ”® ç´«å¾®æ–—æ•°åŠŸèƒ½
- âœ… **å®Œæ•´æŽ’ç›˜**: åäºŒå®«ã€ä¸»æ˜Ÿã€è¾…æ˜Ÿã€æ‚è€€ã€å››åŒ–ç­‰
- âœ… **è¿åŠ¿æŸ¥è¯¢**: å¤§é™ã€æµå¹´ã€æµæœˆã€æµæ—¥ã€æµæ—¶
- âœ… **å®«ä½åˆ†æž**: æ·±åº¦åˆ†æžç‰¹å®šå®«ä½çš„æ˜Ÿæ›œé…ç½®
- âœ… **å¤šç§åŽ†æ³•**: æ”¯æŒé˜³åŽ†å’Œå†œåŽ†è¾“å…¥
- âœ… **æ ¼å¼åŒ–è¾“å‡º**: JSONå’ŒMarkdownä¸¤ç§è¾“å‡ºæ ¼å¼
- â­ **çœŸå¤ªé˜³æ—¶**: æ”¯æŒå…¨çƒ200+åŸŽå¸‚çš„ç²¾ç¡®æ—¶è¾°ä¿®æ­£ **æ–°åŠŸèƒ½**

### ðŸŽ´ å…«å­—åŠŸèƒ½ â­ **æ–°å¢ž**
- âœ… **å››æŸ±æŽ’ç›˜**: å¹´æœˆæ—¥æ—¶å››æŸ±ã€å¤©å¹²åœ°æ”¯è¯¦ç»†ä¿¡æ¯
- âœ… **åç¥žåˆ†æž**: æ¯”è‚©ã€åŠ«è´¢ã€é£Ÿç¥žã€ä¼¤å®˜ã€åè´¢ã€æ­£è´¢ã€ä¸ƒæ€ã€æ­£å®˜ã€åå°ã€æ­£å°
- âœ… **äº”è¡Œåˆ†æž**: é‡‘æœ¨æ°´ç«åœŸåˆ†æ•°ã€ç™¾åˆ†æ¯”ã€å¹³è¡¡åº¦
- âœ… **åœ°æ”¯è—å¹²**: è¯¦ç»†çš„åœ°æ”¯è—å¹²ä¿¡æ¯
- âœ… **è¿åŠ¿æŸ¥è¯¢**: å¤§è¿ã€æµå¹´åˆ†æž
- âœ… **ç¼ºå¤±åˆ†æž**: è‡ªåŠ¨è¯†åˆ«äº”è¡Œç¼ºå¤±å¹¶ç»™å‡ºå»ºè®®
- âœ… **å¤šç§åŽ†æ³•**: æ”¯æŒé˜³åŽ†å’Œå†œåŽ†è¾“å…¥
- â­ **çœŸå¤ªé˜³æ—¶**: æ”¯æŒå…¨çƒ200+åŸŽå¸‚çš„ç²¾ç¡®æ—¶è¾°ä¿®æ­£ **æ–°åŠŸèƒ½**

---

## ðŸ“š æ–‡æ¡£å¯¼èˆª

**æ–°ç”¨æˆ·æŽ¨èé˜…è¯»è·¯å¾„**ï¼š

1. **[å¿«é€Ÿå¼€å§‹æŒ‡å—](docs/QUICK_START.md)** â­ - 5åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹
   - å®‰è£…æ–¹æ³•ï¼ˆuvxã€pipã€Dockerï¼‰
   - IDEé…ç½®ç¤ºä¾‹
   - ç¬¬ä¸€æ¬¡æŽ’ç›˜ä½“éªŒ

2. **[ç”¨æˆ·æŒ‡å—](docs/USER_GUIDE.md)** - å®Œæ•´åŠŸèƒ½è¯´æ˜Ž
   - æ‰€æœ‰å·¥å…·è¯¦è§£
   - å‚æ•°è¯´æ˜Ž
   - è¾“å‡ºæ ¼å¼å¯¹æ¯”
   - ä½¿ç”¨é™åˆ¶

3. **[çœŸå¤ªé˜³æ—¶ä½¿ç”¨æŒ‡å—](docs/TRUE_SOLAR_TIME.md)** â­ - ç²¾ç¡®æ—¶è¾°ä¿®æ­£ï¼ˆæ–°åŠŸèƒ½ï¼‰
   - 200+å…¨çƒåŸŽå¸‚æ”¯æŒ
   - è‡ªåŠ¨æ—¶è¾°ä¿®æ­£
   - é€‚ç”¨äºŽè¥¿åŒ—åœ°åŒº

4. **[APIä½¿ç”¨ç¤ºä¾‹](docs/API_EXAMPLES.md)** - 17ä¸ªå®žç”¨ä»£ç ç¤ºä¾‹
   - åŸºç¡€ç”¨æ³•
   - ç´«å¾®æ–—æ•°ã€å…«å­—ç¤ºä¾‹
   - é«˜çº§æ¨¡å¼ï¼ˆæ‰¹é‡å¤„ç†ã€é”™è¯¯å¤„ç†ï¼‰

5. **[æ•…éšœæŽ’æŸ¥æŒ‡å—](docs/TROUBLESHOOTING.md)** - 16ä¸ªå¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ
   - å®‰è£…é—®é¢˜
   - é…ç½®é—®é¢˜
   - è¿è¡Œæ—¶é”™è¯¯
   - è°ƒè¯•æŠ€å·§

**å¼€å‘è€…æ–‡æ¡£**ï¼š
- **[CLAUDE.md](CLAUDE.md)** - Claude Codeå¼€å‘æŒ‡å—
- **[æ›´å¤šæ–‡æ¡£](docs/README.md)** - å®Œæ•´æ–‡æ¡£ç´¢å¼•

---

## ðŸ“‹ å¯ç”¨å·¥å…·

### 1. get_ziwei_chart
èŽ·å–ç´«å¾®æ–—æ•°å®Œæ•´æŽ’ç›˜ä¿¡æ¯

**å‚æ•°**:
- `date` (string, å¿…éœ€): å‡ºç”Ÿæ—¥æœŸ YYYY-MM-DDï¼Œå¦‚ "2000-08-16"
- `time_index` (integer, å¿…éœ€): æ—¶è¾°åºå· 0-12
  - 0=æ—©å­æ—¶(23-01), 1=ä¸‘æ—¶(01-03), 2=å¯…æ—¶(03-05), 3=å¯æ—¶(05-07)
  - 4=è¾°æ—¶(07-09), 5=å·³æ—¶(09-11), 6=åˆæ—¶(11-13), 7=æœªæ—¶(13-15)
  - 8=ç”³æ—¶(15-17), 9=é…‰æ—¶(17-19), 10=æˆŒæ—¶(19-21), 11=äº¥æ—¶(21-23)
  - 12=æ™šå­æ—¶(23-01)
- `gender` (string, å¿…éœ€): æ€§åˆ« "ç”·" æˆ– "å¥³"
- `calendar` (string, å¯é€‰): åŽ†æ³• "solar"(é˜³åŽ†) æˆ– "lunar"(å†œåŽ†), é»˜è®¤ "solar"
- `is_leap_month` (boolean, å¯é€‰): æ˜¯å¦é—°æœˆï¼Œé»˜è®¤ false
- `format` (string, å¯é€‰): è¾“å‡ºæ ¼å¼ "json" æˆ– "markdown", é»˜è®¤ "markdown"
- `language` (string, å¯é€‰): è¾“å‡ºè¯­è¨€ï¼Œå¯é€‰ "zh-CN", "zh-TW", "en-US", "ja-JP", "ko-KR", "vi-VN"ï¼Œé»˜è®¤ "zh-CN" â­ **æ–°å¢ž**

**ç¤ºä¾‹**:
```json
{
  "date": "2000-08-16",
  "time_index": 2,
  "gender": "å¥³",
  "calendar": "solar"
}
```

### 2. get_ziwei_fortune
èŽ·å–ç´«å¾®æ–—æ•°è¿åŠ¿ä¿¡æ¯

**å‚æ•°**:
- `birth_date` (string, å¿…éœ€): å‡ºç”Ÿæ—¥æœŸ
- `time_index` (integer, å¿…éœ€): æ—¶è¾°åºå·
- `gender` (string, å¿…éœ€): æ€§åˆ«
- `calendar` (string, å¯é€‰): åŽ†æ³•ç±»åž‹
- `query_date` (string, å¯é€‰): æŸ¥è¯¢æ—¥æœŸï¼Œä¸å¡«åˆ™ä¸ºä»Šå¤©
- `format` (string, å¯é€‰): è¾“å‡ºæ ¼å¼
- `language` (string, å¯é€‰): è¾“å‡ºè¯­è¨€ï¼Œé»˜è®¤ "zh-CN" â­ **æ–°å¢ž**

### 3. analyze_ziwei_palace
åˆ†æžç´«å¾®æ–—æ•°ç‰¹å®šå®«ä½

**å‚æ•°**:
- `birth_date` (string, å¿…éœ€): å‡ºç”Ÿæ—¥æœŸ
- `time_index` (integer, å¿…éœ€): æ—¶è¾°åºå·
- `gender` (string, å¿…éœ€): æ€§åˆ«
- `palace_name` (string, å¿…éœ€): å®«ä½åç§°ï¼Œå¯é€‰å€¼ï¼š
  - å‘½å®«ã€å…„å¼Ÿã€å¤«å¦»ã€å­å¥³ã€è´¢å¸›ã€ç–¾åŽ„
  - è¿ç§»ã€ä»†å½¹ã€å®˜ç¦„ã€ç”°å®…ã€ç¦å¾·ã€çˆ¶æ¯
- `calendar` (string, å¯é€‰): åŽ†æ³•ç±»åž‹
- `format` (string, å¯é€‰): è¾“å‡ºæ ¼å¼
- `language` (string, å¯é€‰): è¾“å‡ºè¯­è¨€ï¼Œé»˜è®¤ "zh-CN" â­ **æ–°å¢ž**

### 4. list_fortune_systems
åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„å‘½ç†ç³»ç»Ÿ

### 5. get_bazi_chart â­ **æ–°å¢ž**
èŽ·å–å…«å­—ï¼ˆå››æŸ±ï¼‰æŽ’ç›˜ä¿¡æ¯

**å‚æ•°**:
- `date` (string, å¿…éœ€): å‡ºç”Ÿæ—¥æœŸ YYYY-MM-DD
- `time_index` (integer, å¿…éœ€): æ—¶è¾°åºå· 0-12
- `gender` (string, å¿…éœ€): æ€§åˆ« "ç”·" æˆ– "å¥³"
- `calendar` (string, å¯é€‰): åŽ†æ³• "solar"(é˜³åŽ†) æˆ– "lunar"(å†œåŽ†), é»˜è®¤ "solar"
- `is_leap_month` (boolean, å¯é€‰): æ˜¯å¦é—°æœˆï¼Œé»˜è®¤ false
- `format` (string, å¯é€‰): è¾“å‡ºæ ¼å¼ "json" æˆ– "markdown", é»˜è®¤ "markdown"

**ç¤ºä¾‹**:
```json
{
  "date": "2000-08-16",
  "time_index": 2,
  "gender": "å¥³"
}
```

**è¾“å‡ºåŒ…å«**:
- å››æŸ±å…«å­—ï¼ˆå¹´æœˆæ—¥æ—¶ï¼‰
- å¤©å¹²åœ°æ”¯è¯¦ç»†ä¿¡æ¯
- åç¥žåˆ†æžï¼ˆæ¯”è‚©ã€åŠ«è´¢ç­‰ï¼‰
- äº”è¡Œåˆ†æ•°ç»Ÿè®¡
- åœ°æ”¯è—å¹²ä¿¡æ¯
- ç”Ÿè‚–ã€æ—¥ä¸»ç­‰åŸºæœ¬ä¿¡æ¯

### 6. get_bazi_fortune â­ **æ–°å¢ž**
èŽ·å–å…«å­—è¿åŠ¿ä¿¡æ¯

**å‚æ•°**:
- `birth_date` (string, å¿…éœ€): å‡ºç”Ÿæ—¥æœŸ
- `time_index` (integer, å¿…éœ€): æ—¶è¾°åºå·
- `gender` (string, å¿…éœ€): æ€§åˆ«
- `calendar` (string, å¯é€‰): åŽ†æ³•ç±»åž‹
- `query_date` (string, å¯é€‰): æŸ¥è¯¢æ—¥æœŸï¼Œä¸å¡«åˆ™ä¸ºä»Šå¤©
- `format` (string, å¯é€‰): è¾“å‡ºæ ¼å¼

**è¾“å‡ºåŒ…å«**:
- å½“å‰å¹´é¾„
- å¤§è¿ä¿¡æ¯ï¼ˆå¹´é¾„èŒƒå›´ã€å¹²æ”¯ï¼‰
- æµå¹´ä¿¡æ¯ï¼ˆå¹´ä»½ã€å¹²æ”¯ã€ç”Ÿè‚–ï¼‰
- æœ¬å‘½å…«å­—

### 7. analyze_bazi_element â­ **æ–°å¢ž**
åˆ†æžå…«å­—äº”è¡Œå¼ºå¼±

**å‚æ•°**:
- `birth_date` (string, å¿…éœ€): å‡ºç”Ÿæ—¥æœŸ
- `time_index` (integer, å¿…éœ€): æ—¶è¾°åºå·
- `gender` (string, å¿…éœ€): æ€§åˆ«
- `calendar` (string, å¯é€‰): åŽ†æ³•ç±»åž‹
- `format` (string, å¯é€‰): è¾“å‡ºæ ¼å¼

**è¾“å‡ºåŒ…å«**:
- æ—¥ä¸»åŠå…¶äº”è¡Œå±žæ€§
- äº”è¡Œåˆ†æ•°å’Œç™¾åˆ†æ¯”
- æœ€æ—º/æœ€å¼±äº”è¡Œ
- ç¼ºå¤±äº”è¡Œ
- å¹³è¡¡åº¦è¯„ä»·
- è¡¥æ•‘å»ºè®®

## ðŸš€ å¿«é€Ÿå¼€å§‹

### åœ¨çº¿ä½“éªŒ
- **Smithery éƒ¨ç½²**: [https://server.smithery.ai/@spyfree/mingli-mcp/mcp](https://server.smithery.ai/@spyfree/mingli-mcp/mcp)
- æ·»åŠ åˆ° Cursor: [![Install MCP Server](https://img.shields.io/badge/Cursor-Add+MCP+Server-blue?logo=cursor)](https://cursor.com/install-mcp?name=mingli&config=eyJjb21tYW5kIjoidXZ4IiwiYXJncyI6WyJtaW5nbGktbWNwIl19)
- æ·»åŠ åˆ° Claude Code: `claude mcp add mingli -- uvx mingli-mcp`
- æ·»åŠ åˆ° OpenAI CodeX: `codex mcp add mingli -- uvx mingli-mcp`

---

## ðŸ“¦ å®‰è£…æ–¹å¼

### æ–¹å¼1: uvx (æŽ¨è)

ä½¿ç”¨ `uvx` æ˜¯æœ€ç®€å•çš„å®‰è£…æ–¹å¼ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†ä¾èµ–ï¼š

åœ¨ `~/.cursor/mcp.json` æˆ–å¯¹åº”IDEçš„MCPé…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```json
{
  "mcpServers": {
    "mingli": {
      "command": "uvx",
      "args": ["mingli-mcp"],
      "env": {
        "LOG_LEVEL": "INFO"
      }
    }
  }
}
```

### æ–¹å¼2: Docker

ä½¿ç”¨ Docker éƒ¨ç½²ï¼Œé€‚åˆæœåŠ¡å™¨çŽ¯å¢ƒæˆ–éœ€è¦éš”ç¦»çš„åœºæ™¯ï¼š

```bash
# ä¸‹è½½é…ç½®æ–‡ä»¶
mkdir -p /opt/mingli-mcp
cd /opt/mingli-mcp
wget https://raw.githubusercontent.com/spyfree/mingli-mcp/main/docker-compose.yml

# å¯åŠ¨æœåŠ¡
docker-compose up -d
```

ç„¶åŽåœ¨MCPé…ç½®ä¸­ä½¿ç”¨HTTPè¿žæŽ¥ï¼š

```json
{
  "mcpServers": {
    "mingli": {
      "url": "http://localhost:8080/mcp"
    }
  }
}
```

### æ–¹å¼3: ä»Žæºç å®‰è£…

é€‚åˆå¼€å‘è€…æˆ–éœ€è¦è‡ªå®šä¹‰çš„åœºæ™¯ï¼š

## ðŸ› ï¸ ä»Žæºç å®‰è£…

### çŽ¯å¢ƒè¦æ±‚
- Python 3.8+
- Cursor IDE æˆ–å…¶ä»–æ”¯æŒMCPçš„å·¥å…·

### 1. å…‹éš†é¡¹ç›®
```bash
cd /Users/lix18854/Documents/code
# é¡¹ç›®å·²åœ¨ ziwei_mcp ç›®å½•ä¸­
cd ziwei_mcp
```

### 2. åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒï¼ˆæŽ¨èï¼‰
```bash
python3 -m venv venv
source venv/bin/activate  # macOS/Linux
# æˆ–
venv\Scripts\activate  # Windows
```

### 3. å®‰è£…ä¾èµ–

#### åŸºç¡€å®‰è£…ï¼ˆstdioæ¨¡å¼ï¼ŒæŽ¨èï¼‰
```bash
pip install -r requirements.txt
```

#### æˆ–å®Œæ•´å®‰è£…ï¼ˆåŒ…å«HTTPä¼ è¾“æ”¯æŒï¼‰
```bash
pip install -r requirements-http.txt
# æˆ–ä½¿ç”¨ pip install .[http]
```

> **æ³¨æ„**: stdioæ¨¡å¼æ— éœ€ä»»ä½•é¢å¤–é…ç½®å³å¯ä½¿ç”¨ï¼ŒæŽ¨èæ—¥å¸¸ä½¿ç”¨ã€‚HTTPæ¨¡å¼ä»…åœ¨éœ€è¦Dockeréƒ¨ç½²æˆ–æœåŠ¡å™¨çŽ¯å¢ƒæ—¶ä½¿ç”¨ã€‚

### 4. é…ç½®çŽ¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰
```bash
cp examples/config/.env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶æ ¹æ®éœ€è¦è°ƒæ•´é…ç½®
```

### 5. æµ‹è¯•è¿è¡Œ
```bash
chmod +x mingli_mcp.py
python mingli_mcp.py
```

### 6. é…ç½® Cursor MCP

ç¼–è¾‘æˆ–åˆ›å»º `~/.cursor/mcp.json`:

```json
{
  "mcpServers": {
    "mingli": {
      "command": "/Users/lix18854/Documents/code/ziwei_mcp/venv/bin/python",
      "args": ["/Users/lix18854/Documents/code/ziwei_mcp/mingli_mcp.py"],
      "env": {
        "LOG_LEVEL": "INFO"
      }
    }
  }
}
```

> **æ³¨æ„**: è¯·æ ¹æ®å®žé™…è·¯å¾„è°ƒæ•´ `command` å’Œ `args`

### 7. é‡å¯ Cursor
é‡å¯ Cursor IDE ä»¥åŠ è½½æ–°çš„ MCP é…ç½®ã€‚

## ðŸ“ é¡¹ç›®ç»“æž„

```
ziwei_mcp/
â”œâ”€â”€ mingli_mcp.py              # MCPæœåŠ¡å™¨ä¸»å…¥å£
â”œâ”€â”€ config.py                  # é…ç½®ç®¡ç†
â”œâ”€â”€ requirements.txt           # Pythonä¾èµ–
â”œâ”€â”€ pyproject.toml            # é¡¹ç›®é…ç½®
â”œâ”€â”€ .gitignore                # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ README.md                 # é¡¹ç›®æ–‡æ¡£
â”‚
â”œâ”€â”€ core/                      # æ ¸å¿ƒæŠ½è±¡å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base_system.py        # å‘½ç†ç³»ç»ŸæŠ½è±¡åŸºç±»
â”‚   â”œâ”€â”€ birth_info.py         # ç”Ÿè¾°ä¿¡æ¯æ•°æ®æ¨¡åž‹
â”‚   â””â”€â”€ chart_result.py       # æŽ’ç›˜ç»“æžœæ•°æ®æ¨¡åž‹
â”‚
â”œâ”€â”€ transports/                # ä¼ è¾“å±‚ï¼ˆæ”¯æŒå¤šç§ä¼ è¾“æ–¹å¼ï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base_transport.py     # ä¼ è¾“å±‚æŠ½è±¡åŸºç±»
â”‚   â””â”€â”€ stdio_transport.py    # stdioä¼ è¾“å®žçŽ°ï¼ˆé»˜è®¤ï¼‰
â”‚
â”œâ”€â”€ systems/                   # å‘½ç†ç³»ç»Ÿå®žçŽ°
â”‚   â”œâ”€â”€ __init__.py           # ç³»ç»Ÿæ³¨å†Œä¸­å¿ƒ
â”‚   â”œâ”€â”€ ziwei/                # ç´«å¾®æ–—æ•°ï¼ˆå·²å®žçŽ°ï¼‰
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ ziwei_system.py  # ç³»ç»Ÿå®žçŽ°
â”‚   â”‚   â””â”€â”€ formatter.py     # ç»“æžœæ ¼å¼åŒ–
â”‚   â”œâ”€â”€ bazi/                 # å…«å­—ï¼ˆå·²å®žçŽ°ï¼‰
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ bazi_system.py   # ç³»ç»Ÿå®žçŽ°
â”‚   â”‚   â””â”€â”€ formatter.py     # ç»“æžœæ ¼å¼åŒ–
â”‚   â””â”€â”€ astrology/            # å æ˜Ÿï¼ˆé¢„ç•™ï¼‰
â”‚       â””â”€â”€ __init__.py
â”‚
â”œâ”€â”€ utils/                     # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ validators.py         # å‚æ•°éªŒè¯
â”‚   â””â”€â”€ formatters.py         # å“åº”æ ¼å¼åŒ–
â”‚
â”œâ”€â”€ docs/                      # æ–‡æ¡£
â”‚   â”œâ”€â”€ README.md             # æ–‡æ¡£ç´¢å¼•
â”‚   â”œâ”€â”€ guides/               # ç”¨æˆ·æŒ‡å—
â”‚   â”œâ”€â”€ deployment/           # éƒ¨ç½²æ–‡æ¡£
â”‚   â”œâ”€â”€ architecture/         # æž¶æž„è®¾è®¡
â”‚   â””â”€â”€ development/          # å¼€å‘æ–‡æ¡£
â”‚
â”œâ”€â”€ examples/                  # ç¤ºä¾‹é…ç½®
â”‚   â””â”€â”€ config/               # é…ç½®æ–‡ä»¶ç¤ºä¾‹
â”‚       â”œâ”€â”€ .env.example
â”‚       â”œâ”€â”€ codex_config.toml.example
â”‚       â””â”€â”€ cursor_mcp_config.example.json
â”‚
â”œâ”€â”€ scripts/                   # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ tests/                # æµ‹è¯•è„šæœ¬
â”‚   â””â”€â”€ check_ready_to_publish.sh
â”‚
â””â”€â”€ tests/                     # å•å…ƒæµ‹è¯•
    â””â”€â”€ __init__.py
```

## ðŸš€ æ‰©å±•æ–°å‘½ç†ç³»ç»Ÿ

æœ¬é¡¹ç›®é‡‡ç”¨æ’ä»¶åŒ–æž¶æž„ï¼Œæ·»åŠ æ–°å‘½ç†ç³»ç»Ÿåªéœ€3æ­¥ï¼š

### æ­¥éª¤1: åˆ›å»ºç³»ç»Ÿç±»
åœ¨ `systems/` ä¸‹åˆ›å»ºæ–°ç›®å½•ï¼Œå®žçŽ° `BaseFortuneSystem` æŽ¥å£ï¼š

```python
# systems/bazi/bazi_system.py
from core.base_system import BaseFortuneSystem

class BaziSystem(BaseFortuneSystem):
    def get_system_name(self) -> str:
        return "å…«å­—"
    
    def get_chart(self, birth_info):
        # å®žçŽ°å…«å­—æŽ’ç›˜é€»è¾‘
        return {...}
    
    # å®žçŽ°å…¶ä»–å¿…éœ€æ–¹æ³•...
```

### æ­¥éª¤2: æ³¨å†Œç³»ç»Ÿ
åœ¨ `systems/__init__.py` ä¸­æ³¨å†Œï¼š

```python
from .bazi import BaziSystem
register_system('bazi', BaziSystem)
```

### æ­¥éª¤3: æ·»åŠ MCPå·¥å…·
åœ¨ `mingli_mcp.py` çš„ `_handle_tools_list()` ä¸­æ·»åŠ å·¥å…·å®šä¹‰ã€‚

å°±è¿™ä¹ˆç®€å•ï¼æ— éœ€ä¿®æ”¹æ ¸å¿ƒæ¡†æž¶ä»£ç ã€‚

## ðŸ”§ ä¼ è¾“å±‚æ‰©å±•

å½“å‰é»˜è®¤ä½¿ç”¨ stdio ä¼ è¾“ï¼ˆé€‚ç”¨äºŽ Cursorï¼‰ã€‚æœªæ¥å¯æ‰©å±•ï¼š

### HTTPä¼ è¾“ï¼ˆé¢„ç•™ï¼‰
```python
# transports/http_transport.py
class HttpTransport(BaseTransport):
    def __init__(self, host, port):
        # å®žçŽ°HTTPæœåŠ¡å™¨
        pass
```

### WebSocketä¼ è¾“ï¼ˆé¢„ç•™ï¼‰
```python
# transports/ws_transport.py
class WebSocketTransport(BaseTransport):
    def __init__(self, host, port):
        # å®žçŽ°WebSocketæœåŠ¡å™¨
        pass
```

## ðŸ’¡ æœ€ä½³å®žè·µ

### åœ¨ AI åŠ©æ‰‹ä¸­ä½¿ç”¨

ä¸ŽAIåŠ©æ‰‹ï¼ˆå¦‚Claudeã€Cursorç­‰ï¼‰å¯¹è¯æ—¶ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨è‡ªç„¶è¯­è¨€æŸ¥è¯¢ï¼š

**ç´«å¾®æ–—æ•°ç¤ºä¾‹**ï¼š
- "å¸®æˆ‘æŽ’ä¸€ä¸ªç´«å¾®æ–—æ•°ç›˜ï¼š1990å¹´5æœˆ20æ—¥ï¼Œåˆæ—¶ï¼Œç”·æ€§"
- "æŸ¥è¯¢è¿™ä¸ªäººä»Šå¹´çš„è¿åŠ¿å¦‚ä½•"
- "åˆ†æžä»–çš„è´¢å¸›å®«"
- "çœ‹çœ‹ä»–é€‚åˆä»€ä¹ˆè¡Œä¸š"

**å…«å­—ç¤ºä¾‹**ï¼š
- "å¸®æˆ‘ç®—å…«å­—ï¼š1985å¹´3æœˆ15æ—¥ï¼Œå¯æ—¶ï¼Œå¥³æ€§"  
- "åˆ†æžä¸€ä¸‹å¥¹çš„äº”è¡Œç¼ºä»€ä¹ˆ"
- "çœ‹çœ‹å¥¹ä»Šå¹´çš„å¤§è¿"
- "ä»€ä¹ˆäº”è¡Œçš„é¢œè‰²é€‚åˆå¥¹"

**å†œåŽ†æ”¯æŒ**ï¼š
- "æŽ’ç›˜ï¼šå†œåŽ†1995å¹´7æœˆåˆä¸ƒï¼Œé…‰æ—¶ï¼Œå¥³æ€§"
- "æ³¨æ„æŒ‡å®šæ˜¯å†œåŽ†"

### æç¤ºè¯æŠ€å·§

**è¯¦ç»†æŸ¥è¯¢**ï¼š
```
è¯·å¸®æˆ‘è¯¦ç»†åˆ†æžï¼š
- å‡ºç”Ÿæ—¥æœŸï¼š2000å¹´8æœˆ16æ—¥
- å‡ºç”Ÿæ—¶è¾°ï¼šå¯…æ—¶ï¼ˆæ—©ä¸Š5ç‚¹ï¼‰
- æ€§åˆ«ï¼šå¥³
- ä½¿ç”¨ç´«å¾®æ–—æ•°ç³»ç»Ÿ
- é‡ç‚¹çœ‹äº‹ä¸šå®«å’Œè´¢å¸›å®«
```

**å¯¹æ¯”åˆ†æž**ï¼š
```
è¯·å¯¹æ¯”ä¸¤ä¸ªäººçš„å…«å­—ï¼š
äººAï¼š1990å¹´5æœˆ20æ—¥ï¼Œåˆæ—¶ï¼Œç”·
äººBï¼š1992å¹´3æœˆ15æ—¥ï¼Œè¾°æ—¶ï¼Œå¥³
çœ‹çœ‹ä»–ä»¬çš„äº”è¡Œæ˜¯å¦ç›¸é…
```

**è¿åŠ¿è¿½è¸ª**ï¼š
```
è¯·è®°ä½è¿™ä¸ªäººçš„ä¿¡æ¯ï¼š1988å¹´10æœˆ1æ—¥ï¼Œæœªæ—¶ï¼Œç”·æ€§
ç„¶åŽæ¯ä¸ªæœˆå¸®æˆ‘åˆ†æžå½“æœˆè¿åŠ¿
```

---

## ðŸ“š ä½¿ç”¨ç¤ºä¾‹

### åœ¨ Cursor ä¸­ä½¿ç”¨

ç›´æŽ¥åœ¨å¯¹è¯ä¸­æé—®ï¼š

1. **èŽ·å–ç´«å¾®æŽ’ç›˜**:
```
å¸®æˆ‘æŽ’ä¸€ä¸ªç´«å¾®æ–—æ•°ç›˜ï¼š2000å¹´8æœˆ16æ—¥ï¼Œå¯…æ—¶ï¼Œå¥³æ€§
```

2. **æŸ¥è¯¢è¿åŠ¿**:
```
æŸ¥è¯¢2000å¹´8æœˆ16æ—¥å¯…æ—¶å‡ºç”Ÿçš„å¥³æ€§ï¼Œä»Šå¤©çš„ç´«å¾®è¿åŠ¿
```

3. **åˆ†æžå®«ä½**:
```
åˆ†æžä¸Šé¢è¿™ä¸ªäººçš„å‘½å®«
```

4. **å…«å­—äº”è¡Œåˆ†æž**:
```
å¸®æˆ‘çœ‹çœ‹è¿™ä¸ªäººçš„äº”è¡Œï¼š1995å¹´7æœˆ10æ—¥ï¼Œç”³æ—¶ï¼Œç”·æ€§
```

### ç¼–ç¨‹è°ƒç”¨

```python
from systems import get_system

# èŽ·å–ç´«å¾®ç³»ç»Ÿ
ziwei = get_system('ziwei')

# å‡†å¤‡ç”Ÿè¾°ä¿¡æ¯
birth_info = {
    'date': '2000-08-16',
    'time_index': 2,  # å¯…æ—¶
    'gender': 'å¥³',
    'calendar': 'solar'
}

# èŽ·å–æŽ’ç›˜
chart = ziwei.get_chart(birth_info)
print(chart)

# èŽ·å–è¿åŠ¿
from datetime import datetime
fortune = ziwei.get_fortune(birth_info, datetime.now())
print(fortune)

# åˆ†æžå®«ä½
palace = ziwei.analyze_palace(birth_info, 'å‘½å®«')
print(palace)
```

## ðŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæµ‹è¯•ï¼ˆå¾…å®žçŽ°ï¼‰
pytest tests/

# æµ‹è¯•å•ä¸ªç³»ç»Ÿ
python -m systems.ziwei.ziwei_system
```

## âš™ï¸ é…ç½®è¯´æ˜Ž

æœ¬æœåŠ¡é‡‡ç”¨**é›¶é…ç½®è®¾è®¡**ï¼Œæ‰€æœ‰é…ç½®éƒ½æ˜¯å¯é€‰çš„ï¼ŒæœåŠ¡å™¨æ— éœ€ä»»ä½•é…ç½®å³å¯ç›´æŽ¥è¿è¡Œã€‚

### å¯ç”¨çŽ¯å¢ƒå˜é‡

å¦‚æžœéœ€è¦è‡ªå®šä¹‰è¡Œä¸ºï¼Œå¯é€šè¿‡ä»¥ä¸‹çŽ¯å¢ƒå˜é‡è¿›è¡Œé…ç½®ï¼š

| çŽ¯å¢ƒå˜é‡ | æè¿° | é»˜è®¤å€¼ | ç¤ºä¾‹ |
|---------|------|--------|------|
| `LOG_LEVEL` | æ—¥å¿—çº§åˆ« | `INFO` | `DEBUG`, `INFO`, `WARNING`, `ERROR` |
| `TRANSPORT_TYPE` | ä¼ è¾“åè®®ç±»åž‹ | `stdio` | `stdio`, `http` |
| `HTTP_HOST` | HTTPç›‘å¬åœ°å€ï¼ˆä»…httpæ¨¡å¼ï¼‰ | `0.0.0.0` | `127.0.0.1`, `0.0.0.0` |
| `HTTP_PORT` | HTTPç›‘å¬ç«¯å£ï¼ˆä»…httpæ¨¡å¼ï¼‰ | `8080` | `8080`, `3000` |
| `HTTP_API_KEY` | HTTP APIå¯†é’¥ï¼ˆå¯é€‰ï¼‰ | `""` | `your-secret-key` |
| `DEFAULT_LANGUAGE` | é»˜è®¤è¾“å‡ºè¯­è¨€ | `zh-CN` | `zh-CN`, `zh-TW`, `en-US`, `ja-JP`, `ko-KR`, `vi-VN` |

### é…ç½®æ–¹æ³•

**æ–¹æ³•1: åœ¨MCPé…ç½®ä¸­è®¾ç½®**
```json
{
  "mcpServers": {
    "mingli": {
      "command": "uvx",
      "args": ["mingli-mcp"],
      "env": {
        "LOG_LEVEL": "DEBUG",
        "DEFAULT_LANGUAGE": "zh-TW"
      }
    }
  }
}
```

**æ–¹æ³•2: ä½¿ç”¨ .env æ–‡ä»¶**
```bash
# åˆ›å»º .env æ–‡ä»¶
cat > .env << EOF
LOG_LEVEL=INFO
DEFAULT_LANGUAGE=zh-CN
TRANSPORT_TYPE=stdio
EOF
```

**æ–¹æ³•3: ç³»ç»ŸçŽ¯å¢ƒå˜é‡**
```bash
export LOG_LEVEL=DEBUG
export DEFAULT_LANGUAGE=zh-CN
python mingli_mcp.py
```

## ðŸ“ ä¾èµ–è¯´æ˜Ž

- **iztro-py**: ç´«å¾®æ–—æ•°æ ¸å¿ƒåº“ï¼ˆçº¯ Python å®žçŽ°ï¼Œæ€§èƒ½æ¯” py-iztro æå‡ 10 å€ï¼‰
- **python-dotenv**: çŽ¯å¢ƒå˜é‡ç®¡ç†
- **python-dateutil**: æ—¥æœŸå¤„ç†

## ðŸ—ºï¸ æœªæ¥è§„åˆ’

- [ ] å®Œå–„å…«å­—ç³»ç»Ÿå®žçŽ°
- [ ] æ·»åŠ è¥¿æ–¹å æ˜Ÿç³»ç»Ÿ
- [ ] å®žçŽ°åˆç›˜åŠŸèƒ½
- [ ] HTTP/WebSocketä¼ è¾“å±‚
- [ ] å‘½ç†çŸ¥è¯†åº“é›†æˆ
- [ ] AIè§£è¯»åŠŸèƒ½
- [ ] æ›´å¤šè¿åŠ¿åˆ†æžç»´åº¦

## ðŸ¤ è´¡çŒ®

æ¬¢è¿Žè´¡çŒ®ä»£ç ã€æŠ¥å‘Šé—®é¢˜æˆ–æå‡ºå»ºè®®ï¼

## ðŸ“„ è®¸å¯è¯

MIT License

## ðŸ™ è‡´è°¢

- [iztro](https://github.com/SylarLong/iztro) - ç´«å¾®æ–—æ•° JavaScript åº“ï¼ˆåŽŸå§‹ç®—æ³•æ¥æºï¼‰
- [iztro-py](https://github.com/spyfree/iztro-py) - ç´«å¾®æ–—æ•°çº¯ Python å®žçŽ°
- [MCP Protocol](https://modelcontextprotocol.io/) - Model Context Protocol è§„èŒƒ

---

**ðŸ”® å¼€å§‹ä½ çš„å‘½ç†æŽ¢ç´¢ä¹‹æ—…ï¼**
